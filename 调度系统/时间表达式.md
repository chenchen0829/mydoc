## 表达式类型

##  

```
1：cron cron表达式。
2：Fixed rate 固定时间间隔(比如40min/次) 固定频率一般分钟级别。
3：Fixed Delay 每次执行完成之后，延迟时间再次触发。一般用于秒级任务。
```



## 任务类型

```
1： 定时任务
    ag: 每天1:00 执行， 每天周执行一次， 40mins执行一次(需要用Fixed rate)
   
     
2： 依赖任务
    ag: 上游执行完毕之后，立即调用当前任务

3： 定时+依赖任务
		ag: 上游1:00执行完毕，下游4:00开始执行。
    
4: 固定延迟任务
    ag: 下一次再上一次执行完成之后10mins开始执行。
    
5：固定延迟任务+依赖    
		ag: 下一次再上一次执行完成之后10mins，并且检测上游依赖。
		
		

```





## 下一次执行时间计算

```
下一次执行时间计算是调度系统比较重要的功能
1： 定时任务 / 定时依赖任务
	 可以使用quartz工具类，根据crontab推出下一次的执行时间.在系统重启的时候，可以根据任务的最后一次恢复时间(任务最后一次执行成功需要的时间)和当前时间，来推断出需要恢复的时间.(最后一次恢复的时间，当前时间)的任务数。
2： 依赖任务 	 
	 依赖任务下一次的执行时间，是根据上游依赖任务的调度完成时间决定的。一般上游依赖任务可能是时间有关的任务。在系统重启的时候，需要向上递归计算出来最后一次的执行时间。(需要递归计算出来任务最后一次恢复时间，到当前时间的执行时间数，然后一次生成)， 上游依赖的任务可能是纯依赖，时间依赖，时间，等等。所以需要依次递归来生成。
3：固定延迟任务
	只需要计算出来上一次执行完成的时间。再加上延迟时间即可。
	 
	 



可能产生的问题：
1：如果任务好像时间没有执行，没有配置监控提醒。在系统重启的时候，需要花费很多时间去重新计算上游的任务。这个挺麻烦的。
2：任务在修改调度时间和依赖的时候，在这个时候系统挂掉了，就容易上不到上游。这个时候就要手动去操作。或者针对这种情况做补偿。
```

